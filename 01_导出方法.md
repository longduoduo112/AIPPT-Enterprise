<!--
input: SKILL.md（Step 1 调用）、PPT 模板文件
output: 02_PPT模板分析方法.md（垫图给它分析）
pos: 阶段1，工作流起点

架构守护者：一旦我被修改，请同步更新：
1. 本文件的头部注释
2. README.md 索引表
-->

# PPT 导出为图片

将PPT模板导出为图片，作为垫图使用。

---

## 推荐方法：PDF 转图片

最可靠的方法，保证字体正确。

### 步骤1：导出 PDF

用 **WPS / Office / Keynote** 打开 PPT，导出为 PDF：

- WPS：文件 → 输出为PDF
- Office：文件 → 导出 → PDF
- Keynote：文件 → 导出到 → PDF

> 这一步确保字体正确嵌入 PDF

### 步骤2：PDF 转图片

```bash
# Mac/Linux（需要安装 poppler）
# Mac: brew install poppler
# Ubuntu: apt install poppler-utils

pdftoppm -png -r 300 "模板.pdf" "输出目录/图"
```

**参数说明**：
- `-png`：输出 PNG 格式
- `-r 300`：300 DPI 高清
- 输出文件自动命名为 `图-01.png`, `图-02.png` ...

### 步骤3：重命名（可选）

```bash
# 将 图-01.png 改为 图.001.png
cd 输出目录
for f in 图-*.png; do
  n=$(echo "$f" | sed 's/图-\([0-9]*\)/图.\1/' | sed 's/图\.\([0-9]\)\.png/图.00\1.png/' | sed 's/图\.\([0-9][0-9]\)\.png/图.0\1.png/')
  mv "$f" "$n"
done
```

---

## 备选方法

### Mac（Keynote CLI）

```bash
osascript <<'EOF'
tell application "Keynote"
    open POSIX file "/路径/模板.pptx"
    delay 3
    export front document to POSIX file "/输出目录" as slide images with properties {image format:PNG}
    close front document saving no
end tell
EOF
```

> 注意：如果系统缺字体，导出会有问题

### Windows（PowerShell）

```powershell
$ppt = New-Object -ComObject PowerPoint.Application
$presentation = $ppt.Presentations.Open("C:\路径\模板.pptx")
foreach ($slide in $presentation.Slides) {
    $slide.Export("C:\输出目录\slide$($slide.SlideIndex).png", "PNG")
}
$presentation.Close()
$ppt.Quit()
```

---

## 产出物

**位置**：`模板/{模板名}/图/`

**命名**：
```
图.001.png
图.002.png
图.003.png
...
```

**目录结构**：
```
模板/{模板名}/
├── 模板.pptx（原文件）
├── 模板.pdf（中间文件）
└── 图/
    ├── 图.001.png
    ├── 图.002.png
    ├── 图.003.png
    └── ...
```
